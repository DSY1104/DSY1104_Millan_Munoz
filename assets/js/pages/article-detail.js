/*
===========================================
JAVASCRIPT PARA DETALLE DE ART칈CULO
===========================================
*/

// Contenido completo de los art칤culos
const articleContent = {
  1: {
    title: "Los mejores auriculares gaming de 2024",
    category: "reviews",
    date: "2024-09-10",
    readingTime: "5 min",
    image:
      "https://via.placeholder.com/800x300/1e90ff/ffffff?text=Auriculares+Gaming",
    content: `
      <h2>La revoluci칩n del audio gaming</h2>
      <p>El mundo del gaming ha evolucionado enormemente en los 칰ltimos a침os, y el audio no se ha quedado atr치s. Los auriculares gaming de 2024 ofrecen una experiencia sonora inmersiva que puede marcar la diferencia entre la victoria y la derrota.</p>
      
      <h2>Caracter칤sticas que debes buscar</h2>
      <p>Al elegir auriculares gaming, es fundamental considerar varios aspectos clave. La calidad del sonido 7.1 surround te permitir치 localizar enemigos con precisi칩n, mientras que un micr칩fono de alta calidad asegurar치 una comunicaci칩n clara con tu equipo.</p>
      
      <p>La comodidad tambi칠n es crucial, especialmente durante sesiones de gaming prolongadas. Los mejores auriculares cuentan con almohadillas de memory foam y diademas ajustables que distribuyen el peso de manera uniforme.</p>
      
      <h2>Nuestras recomendaciones top</h2>
      <p>Despu칠s de exhaustivas pruebas, hemos seleccionado los modelos que destacan por su excelente relaci칩n calidad-precio, innovaci칩n tecnol칩gica y satisfacci칩n del usuario. Cada uno ofrece caracter칤sticas 칰nicas que los hacen ideales para diferentes tipos de gamers.</p>
      
      <p>Ya seas un competidor profesional que necesita la m치xima precisi칩n sonora, o un casual gamer que busca una experiencia inmersiva, tenemos la opci칩n perfecta para ti en nuestra selecci칩n.</p>
    `,
  },
  2: {
    title: "Gu칤a completa para configurar tu setup gaming",
    category: "guias",
    date: "2024-09-08",
    readingTime: "8 min",
    image:
      "https://via.placeholder.com/800x300/39ff14/000000?text=Setup+Gaming",
    content: `
      <h2>Creando el espacio perfecto</h2>
      <p>Un buen setup gaming va m치s all치 de tener componentes potentes. Se trata de crear un ambiente que potencie tu rendimiento y haga que cada sesi칩n de juego sea memorable.</p>
      
      <h2>Ergonom칤a: La base de todo</h2>
      <p>La ergonom칤a es fundamental para mantener la salud durante largas sesiones de gaming. Una silla gaming de calidad, un escritorio a la altura adecuada y una posici칩n correcta del monitor pueden prevenir lesiones y mejorar tu concentraci칩n.</p>
      
      <h2>Iluminaci칩n RGB inteligente</h2>
      <p>La iluminaci칩n RGB no es solo est칠tica; puede mejorar la atm칩sfera de juego y reducir la fatiga visual. Aprende a configurar perfiles de color que complementen tus juegos favoritos y creen la ambientaci칩n perfecta.</p>
      
      <h2>Organizaci칩n y gesti칩n de cables</h2>
      <p>Un setup organizado no solo se ve profesional, sino que tambi칠n facilita el mantenimiento y mejora el flujo de aire. Te ense침amos las mejores t칠cnicas para manejar cables y mantener tu espacio limpio y funcional.</p>
    `,
  },
  3: {
    title: "Nuevos lanzamientos de monitores 4K para gaming",
    category: "noticias",
    date: "2024-09-05",
    readingTime: "4 min",
    image:
      "https://via.placeholder.com/800x300/ff6b35/ffffff?text=Monitores+4K",
    content: `
      <h2>La era del 4K gaming ha llegado</h2>
      <p>Los nuevos monitores 4K para gaming est치n redefiniendo los est치ndares de calidad visual. Con tasas de refresco de hasta 144Hz y tecnolog칤as HDR avanzadas, estos displays ofrecen una experiencia visual sin precedentes.</p>
      
      <h2>Tecnolog칤as destacadas</h2>
      <p>Los monitores de este a침o incorporan tecnolog칤as como OLED, Mini-LED y Quantum Dot que proporcionan colores m치s vibrantes, negros m치s profundos y un contraste excepcional. Adem치s, la compatibilidad con G-Sync y FreeSync elimina el tearing y stuttering.</p>
      
      <h2>Disponibilidad y precios</h2>
      <p>Aunque inicialmente los precios eran prohibitivos, la competencia ha hecho que los monitores 4K gaming sean m치s accesibles. En LevelUp encontrar치s las mejores ofertas y opciones de financiamiento para hacer realidad tu setup so침ado.</p>
    `,
  },
  4: {
    title: "Review: Teclado mec치nico RGB para pros",
    category: "reviews",
    date: "2024-09-03",
    readingTime: "6 min",
    image: "https://via.placeholder.com/800x300/9d4edd/ffffff?text=Teclado+RGB",
    content: `
      <h2>An치lisis completo del teclado definitivo</h2>
      <p>Este teclado mec치nico RGB representa la evoluci칩n natural de los perif칠ricos gaming. Con switches personalizados, retroiluminaci칩n avanzada y construcci칩n premium, est치 dise침ado para satisfacer las demandas m치s exigentes.</p>
      
      <h2>Rendimiento en competici칩n</h2>
      <p>Durante nuestras pruebas intensivas, el teclado demostr칩 una respuesta excepcional con tiempos de actuaci칩n de apenas 1ms. Los switches proporcionan un feedback t치ctil perfecto que mejora significativamente la precisi칩n en juegos competitivos.</p>
      
      <h2>Personalizaci칩n sin l칤mites</h2>
      <p>El software incluido permite personalizar cada tecla individualmente, crear macros complejas y sincronizar la iluminaci칩n con otros perif칠ricos. La configuraci칩n por perfiles hace que adaptarse a diferentes juegos sea instant치neo.</p>
      
      <h2>Veredicto final</h2>
      <p>Con una construcci칩n s칩lida, caracter칤sticas premium y un precio competitivo, este teclado se posiciona como una excelente inversi칩n para gamers serios que buscan llevar su rendimiento al siguiente nivel.</p>
    `,
  },
  5: {
    title: "Evento LevelUp: Torneo de gaming",
    category: "eventos",
    date: "2024-08-30",
    readingTime: "3 min",
    image:
      "https://via.placeholder.com/800x300/f72585/ffffff?text=Torneo+Gaming",
    content: `
      <h2>El evento gaming del a침o</h2>
      <p>LevelUp se enorgullece en presentar el torneo de gaming m치s espectacular de la temporada. Con premios valorados en m치s de $50,000 y la participaci칩n de los mejores equipos profesionales del pa칤s.</p>
      
      <h2>Modalidades y categor칤as</h2>
      <p>El torneo incluir치 competencias en m칰ltiples t칤tulos: CS2, League of Legends, Valorant y FIFA 24. Habr치 categor칤as para profesionales, semi-profesionales y amateurs, asegurando que todos puedan participar.</p>
      
      <h2>C칩mo participar</h2>
      <p>Las inscripciones est치n abiertas hasta el 15 de septiembre. Visita nuestro sitio web, completa tu registro y prep치rate para la competencia m치s emocionante del a침o. 춰Los cupos son limitados!</p>
      
      <h2>Premios y reconocimientos</h2>
      <p>Adem치s de los premios en efectivo, los ganadores recibir치n equipamiento gaming de 칰ltima generaci칩n, contratos de patrocinio y la oportunidad de representar a LevelUp en competencias internacionales.</p>
    `,
  },
  6: {
    title: "Top 10 juegos m치s esperados",
    category: "gaming",
    date: "2024-08-28",
    readingTime: "7 min",
    image:
      "https://via.placeholder.com/800x300/4cc9f0/000000?text=Top+10+Juegos",
    content: `
      <h2>Los t칤tulos que definir치n el gaming</h2>
      <p>El 2024 promete ser un a침o excepcional para los videojuegos. Desde secuelas muy esperadas hasta nuevas IPs que prometen revolucionar sus g칠neros, nuestra lista incluye los t칤tulos que no puedes perderte.</p>
      
      <h2>Innovaci칩n en cada g칠nero</h2>
      <p>Veremos avances significativos en inteligencia artificial, gr치ficos ray-tracing y mec치nicas de gameplay innovadoras. Los desarrolladores est치n aprovechando al m치ximo el hardware de nueva generaci칩n para crear experiencias 칰nicas.</p>
      
      <h2>Lo que viene en los pr칩ximos meses</h2>
      <p>Desde RPGs 칠picos hasta shooters revolucionarios, cada mes traer치 nuevos lanzamientos que mantendr치n a los gamers pegados a sus pantallas. Prepara tu wishlist y tu presupuesto porque ser치 un a침o costoso para los fan치ticos.</p>
      
      <h2>Reservas y ediciones especiales</h2>
      <p>En LevelUp ya tenemos disponibles las reservas para los t칤tulos m치s esperados. No te quedes sin tu copia y aprovecha nuestras ofertas exclusivas para pre-orders.</p>
    `,
  },
  // Agregar m치s contenido seg칰n sea necesario
};

// Variables globales
let currentArticle = null;

// Inicializaci칩n
document.addEventListener("DOMContentLoaded", function () {
  loadArticle();
});

// Cargar art칤culo desde localStorage o URL
function loadArticle() {
  // Intentar cargar desde localStorage primero
  const storedArticle = localStorage.getItem("currentArticle");

  if (storedArticle) {
    currentArticle = JSON.parse(storedArticle);
    renderArticle();
  } else {
    // Si no hay art칤culo guardado, extraer ID de la URL
    const urlPath = window.location.pathname;
    const match = urlPath.match(/post-(\d+)\.html/);

    if (match) {
      const articleId = parseInt(match[1]);
      loadArticleById(articleId);
    } else {
      showError();
    }
  }
}

// Cargar art칤culo por ID
function loadArticleById(id) {
  // En una aplicaci칩n real, esto har칤a una petici칩n al servidor
  // Por ahora, usamos datos locales
  const articleData = articleContent[id];

  if (articleData) {
    currentArticle = {
      id,
      ...articleData,
    };
    renderArticle();
  } else {
    showError();
  }
}

// Renderizar art칤culo
function renderArticle() {
  if (!currentArticle) {
    showError();
    return;
  }

  const articleContainer = document.getElementById("article-content");
  const loadingIndicator = articleContainer.querySelector(".loading-indicator");

  // Ocultar indicador de carga
  loadingIndicator.style.display = "none";

  // Actualizar t칤tulo de la p치gina
  document.title = `${currentArticle.title} - LevelUp Blog`;

  // Crear contenido del art칤culo
  const articleHTML = `
    <div class="article-hero">
      <img src="${currentArticle.image}" 
           alt="Imagen del art칤culo: ${currentArticle.title}"
           loading="eager">
    </div>
    
    <div class="article-meta-detail">
      <div>
        <span class="article-category">${getCategoryName(
          currentArticle.category
        )}</span>
        <h1 class="article-title">${currentArticle.title}</h1>
      </div>
      <div>
        <time class="article-date" datetime="${currentArticle.date}">
          ${formatDate(currentArticle.date)}
        </time>
        <span class="article-reading-time">游닀 ${
          currentArticle.readingTime
        }</span>
      </div>
    </div>
    
    <div class="article-content-detail">
      ${currentArticle.content}
    </div>
  `;

  articleContainer.innerHTML = articleHTML;

  // Cargar art칤culos relacionados
  loadRelatedArticles();
}

// Cargar art칤culos relacionados
function loadRelatedArticles() {
  if (!currentArticle) return;

  // Simular art칤culos relacionados (en una app real vendr칤a del servidor)
  const relatedArticles = [
    {
      id: 4,
      title: "Review: Teclado mec치nico RGB para pros",
      description:
        "Probamos el 칰ltimo teclado mec치nico RGB dise침ado para jugadores profesionales.",
      category: "reviews",
      date: "2024-09-03",
      image:
        "https://via.placeholder.com/400x200/9d4edd/ffffff?text=Teclado+RGB",
      readingTime: "6 min",
    },
    {
      id: 5,
      title: "Evento LevelUp: Torneo de gaming",
      description: "춰Prep치rate para el torneo de gaming m치s grande del a침o!",
      category: "eventos",
      date: "2024-08-30",
      image:
        "https://via.placeholder.com/400x200/f72585/ffffff?text=Torneo+Gaming",
      readingTime: "3 min",
    },
  ];

  const relatedContainer = document.getElementById(
    "related-articles-container"
  );
  const relatedHTML = relatedArticles
    .map((article) => createRelatedArticleCard(article))
    .join("");
  relatedContainer.innerHTML = relatedHTML;

  // Agregar event listeners
  setupRelatedArticleListeners();
}

// Crear tarjeta de art칤culo relacionado
function createRelatedArticleCard(article) {
  return `
    <article class="article-card" 
             data-article-id="${article.id}"
             tabindex="0"
             role="button"
             aria-label="Leer art칤culo relacionado: ${article.title}">
      <div class="article-image">
        <img src="${article.image}" 
             alt="Imagen del art칤culo: ${article.title}"
             loading="lazy">
      </div>
      
      <div class="article-content">
        <div class="article-meta">
          <span class="article-category">${getCategoryName(
            article.category
          )}</span>
          <time class="article-date" datetime="${article.date}">
            ${formatDate(article.date)}
          </time>
        </div>
        
        <h3 class="article-title">${article.title}</h3>
        <p class="article-description">${article.description}</p>
        
        <div class="article-footer">
          <button class="read-more-btn">Leer m치s</button>
          <span class="article-reading-time">游닀 ${article.readingTime}</span>
        </div>
      </div>
    </article>
  `;
}

// Configurar listeners para art칤culos relacionados
function setupRelatedArticleListeners() {
  const relatedCards = document.querySelectorAll(
    "#related-articles-container .article-card"
  );

  relatedCards.forEach((card) => {
    card.addEventListener("click", handleRelatedArticleClick);
    card.addEventListener("keydown", (event) => {
      if (event.key === "Enter" || event.key === " ") {
        event.preventDefault();
        handleRelatedArticleClick(event);
      }
    });
  });
}

// Manejar click en art칤culo relacionado
function handleRelatedArticleClick(event) {
  const articleId = event.currentTarget.getAttribute("data-article-id");

  // Actualizar URL y cargar nuevo art칤culo
  const newUrl = `post-${articleId.padStart(2, "0")}.html`;
  window.history.pushState({}, "", newUrl);

  loadArticleById(parseInt(articleId));

  // Scroll al inicio
  window.scrollTo({ top: 0, behavior: "smooth" });
}

// Mostrar error
function showError() {
  const articleContainer = document.getElementById("article-content");
  articleContainer.innerHTML = `
    <div class="empty-state active">
      <h3>Art칤culo no encontrado</h3>
      <p>Lo sentimos, el art칤culo que buscas no est치 disponible.</p>
      <a href="../index.html" class="back-button">Volver al blog</a>
    </div>
  `;
}

// Formatear fecha
function formatDate(dateString) {
  const date = new Date(dateString);
  const options = {
    year: "numeric",
    month: "long",
    day: "numeric",
  };
  return date.toLocaleDateString("es-ES", options);
}

// Obtener nombre de categor칤a
function getCategoryName(category) {
  const categoryNames = {
    gaming: "Gaming",
    reviews: "Reviews",
    noticias: "Noticias",
    guias: "Gu칤as",
    eventos: "Eventos",
  };
  return categoryNames[category] || category;
}

// Limpiar localStorage al salir
window.addEventListener("beforeunload", function () {
  // Solo limpiar si vamos a otra p치gina que no sea del blog
  if (!document.referrer.includes("/blog/")) {
    localStorage.removeItem("currentArticle");
  }
});

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Test for Reviews</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 600px; 
            margin: 50px auto; 
            padding: 20px; 
            background: #000; 
            color: #fff; 
        }
        button { 
            background: #1e90ff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            margin: 10px 5px; 
            border-radius: 4px; 
            cursor: pointer; 
        }
        .status { 
            padding: 15px; 
            margin: 15px 0; 
            border-radius: 4px; 
            background: #333; 
        }
        .logged-in { background: #004d00; }
        .logged-out { background: #4d0000; }
    </style>
</head>
<body>
    <h1>Test Login for Reviews System</h1>
    
    <div id="status" class="status">
        Checking login status...
    </div>
    
    <button onclick="simulateLogin()">Simulate Login (test@example.com)</button>
    <button onclick="simulateLogout()">Simulate Logout</button>
    <button onclick="goToProductDetail()">Go to Product Detail (JM001)</button>
    
    <script>
        function checkLoginStatus() {
            try {
                const sessionData = document.cookie
                    .split('; ')
                    .find(row => row.startsWith('userSession='));
                
                const statusDiv = document.getElementById('status');
                
                if (sessionData) {
                    const session = JSON.parse(decodeURIComponent(sessionData.split('=')[1]));
                    if (session && session.isAuthenticated) {
                        statusDiv.textContent = `Logged in as: ${session.email}`;
                        statusDiv.className = 'status logged-in';
                        return true;
                    }
                }
                
                statusDiv.textContent = 'Not logged in';
                statusDiv.className = 'status logged-out';
                return false;
            } catch (error) {
                document.getElementById('status').textContent = 'Error checking login status';
                return false;
            }
        }
        
        function simulateLogin() {
            const mockSession = {
                email: 'test@example.com',
                isAuthenticated: true,
                loginTime: new Date().toISOString()
            };
            
            // Also create a mock user registration
            const mockRegistration = {
                firstName: 'Usuario',
                lastName: 'Prueba',
                email: 'test@example.com',
                id: 'user_' + Date.now()
            };
            
            document.cookie = `userSession=${encodeURIComponent(JSON.stringify(mockSession))}; path=/`;
            localStorage.setItem('userRegistration', JSON.stringify(mockRegistration));
            
            checkLoginStatus();
        }
        
        function simulateLogout() {
            document.cookie = 'userSession=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
            localStorage.removeItem('userRegistration');
            checkLoginStatus();
        }
        
        function goToProductDetail() {
            window.location.href = '/pages/products/detail.html?code=JM001';
        }
        
        // Check status on load
        checkLoginStatus();
    </script>
</body>
</html>
